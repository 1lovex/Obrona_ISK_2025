# Pytanie 20. Protokoły routingu

Protokoły routingu.

## Stachu

Poniżej linki do stron w Wikipedii:

- [RIP](https://pl.wikipedia.org/wiki/Routing_Information_Protocol)
- [IGRP](https://pl.wikipedia.org/wiki/Interior_Gateway_Routing_Protocol)
- [EIGRP](https://pl.wikipedia.org/wiki/Enhanced_Interior_Gateway_Routing_Protocol)
- [OSPF](https://pl.wikipedia.org/wiki/Open_Shortest_Path_First)
- [IS-IS](https://pl.wikipedia.org/wiki/IS-IS) (Allah beloved)

## Kuba

Proces wyznaczania optymalnej ścieżki dla pakietów danych w sieci. **Urządzenia (routery) wymieniają się informacjami o dostępnych trasach** za pomocą protokołów routingu, budując Tablicę Routingu.

**Kluczowym pojęciem jest System Autonomiczny (AS - Autonomous System)** – zbiór sieci pod jedną administracją (np. ISP, korporacja).

## Klasyfikacja protokołów (Podejście Cisco)

### A. Ze względu na obszar działania (AS)

- **IGP** (Interior Gateway Protocols): Działają wewnątrz AS (RIP, EIGRP, OSPF, IS-IS)
- **EGP** (Exterior Gateway Protocols): Działają pomiędzy AS (BGP)

### B. Ze względu na sposób działania (Algorytm)

#### Distance Vector (Wektor odległości)

- Router widzi sieć tylko oczami sąsiadów ("Sąsiad A mówi, że do sieci X jest 5 skoków")
- Nie zna pełnej mapy sieci
- Przykłady: RIP (algorytm Bellmana-Forda)

#### Link State (Stan łącza)

- Router posiada pełną mapę całej sieci (każdy router wie o każdym łączu)
- Przykłady: OSPF, IS-IS (algorytm Dijkstry / SPF)

#### Hybrid / Advanced Distance Vector

- Łączy cechy obu powyższych
- Przykład: EIGRP (algorytm DUAL)

### C. Ze względu na obsługę masek (Ważne na Cisco!)

- **Classful (Klasowe):** Nie przesyłają maski podsieci w aktualizacjach. Nie obsługują VLSM (Stare: RIPv1, IGRP)
- **Classless (Bezklasowe):** Przesyłają maskę podsieci. Obsługują VLSM (zmienną długość maski) i CIDR (Współczesne: RIPv2, EIGRP, OSPF, BGP)

## Szczegółowy opis protokołów

### 1. RIP (Routing Information Protocol)

- **Wersje:** RIPv1 (Classful), RIPv2 (Classless - obsługuje VLSM)
- **Typ:** Wektor odległości
- **Algorytm:** Bellmana-Forda
- **Metryka:** Liczba skoków (Hop Count). Max **15 skoków** (16 = nieskończoność/sieć nieosiągalna)
- **Cechy:** Wysyła pełną tablicę routingu co 30 sekund (multicast 224.0.0.9 dla v2). Wolna zbieżność, podatny na pętle routingu

### 2. OSPF (Open Shortest Path First)

- **Typ:** Stan łącza (Link State)
- **Algorytm:** Dijkstry (SPF - Shortest Path First)
- **Metryka:** Koszt (Cost) = $$\frac{10^8}{\text{Przepustowość}}$$
  Im szybsze łącze, tym niższy koszt

**Struktura:**

- **Tablica Sąsiadów (Neighbor Table):** Lista routerów, z którymi nawiązano relację (Hello packets)
- **Tablica Topologii (LSDB):** Pełna mapa sieci (taka sama na każdym routerze w obszarze)
- **Tablica Routingu:** Tylko najlepsze trasy wyliczone z LSDB

**Obszary (Areas):** Wymaga hierarchii. Wszystkie obszary muszą stykać się z **Area 0 (Backbone)**.

### 3. EIGRP (Enhanced Interior Gateway Routing Protocol)

- **Typ:** Hybrydowy (Cisco nazywa go "Advanced Distance Vector")
- **Algorytm:** DUAL (Diffusing Update Algorithm) – klucz do szybkości EIGRP. Gwarantuje brak pętli
- **Metryka:** Złożona (K-values). Domyślnie: Przepustowość (Bandwidth) + Opóźnienie (Delay)

$$\text{Metryka} = \left[\frac{10^7}{\text{MinBW}} + \frac{\text{SumDelay}}{10}\right] \times 256$$

**Cechy:**

- Najszybsza konwergencja (zbieżność) dzięki Feasible Successor (zapasowa trasa gotowa do użycia natychmiast po awarii głównej)
- Obsługuje Unequal Cost Load Balancing (rozłożenie ruchu na łącza o różnej prędkości)
- Protokół własnościowy Cisco (choć częściowo otwarty w 2013)

### 4. BGP (Border Gateway Protocol)

- **Typ:** Wektor ścieżki (Path Vector)
- **Zastosowanie:** Internet, łączenie ISP
- **Cechy:**
  - Bardzo wolny, ale skalowalny (obsługuje miliony tras)
  - Decyzje oparte na atrybutach (AS-PATH, Local Preference, MED), a nie tylko na prędkości

## Dystans Administracyjny (AD) - Komu ufa router?

Gdy router ma trasę do tej samej sieci z dwóch źródeł, wybiera tę z **niższym AD**.

| Źródło trasy             | AD (Zaufanie) |
| ------------------------ | ------------- |
| Connected (Bezpośrednia) | 0             |
| Static (Statyczna)       | 1             |
| EIGRP Summary            | 5             |
| eBGP                     | 20            |
| EIGRP (Internal)         | 90            |
| OSPF                     | 110           |
| RIP                      | 120           |

## Streszczenie

- ✅ **Klasyfikacja:** IGP vs EGP, Distance Vector vs Link State, Classful vs Classless (VLSM)
- ✅ **RIP:** Algorytm Bellmana-Forda, metryka Hop Count (max 15), wolny
- ✅ **OSPF:** Algorytm Dijkstry, Link State, metryka Koszt (Bandwidth), Area 0, trzy tablice (Neighbor, Topology, Routing)
- ✅ **EIGRP:** Algorytm DUAL, metryka Bandwidth+Delay, Feasible Successor (zapasowa trasa), bardzo szybki
- ✅ **AD:** Kolejność zaufania (Static > EIGRP > OSPF > RIP)
