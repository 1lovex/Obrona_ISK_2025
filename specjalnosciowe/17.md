# Pytanie 17. Współczesne algorytmy kryptograficzne

## Kuba

Kryptografia to nauka o zabezpieczaniu informacji. Współczesne algorytmy dzielimy na dwie główne grupy: symetryczne (z jednym kluczem) oraz asymetryczne (z parą kluczy).

### Algorytmy symetryczne (z kluczem prywatnym)

W tej metodzie ten sam klucz służy zarówno do szyfrowania, jak i deszyfrowania wiadomości. Obie strony komunikacji muszą posiadać ten sam tajny klucz.

#### Podział algorytmów symetrycznych

- **Blokowe (Block):** Tekst jawny jest dzielony na bloki o stałej długości (np. 64 lub 128 bitów), a każdy blok szyfrowany jest oddzielnie.
- **Strumieniowe (Stream):** Tekst jest szyfrowany bit po bicie lub bajt po bajcie.

#### Najpopularniejsze algorytmy symetryczne

- **DES:** Klasyczny algorytm blokowy (klucz efektywny 56-bitowy | cały 64 - 8 bitów parzystości). Obecnie uważany za mało bezpieczny (podatny na ataki typu brute-force). Zaakceptowany w 1977 r. Przez Narodowe Biuro Standardów USA. Dane są szyfrowane w 64-bitowych blokach z zastosowaniem 56 bitowego klucza. Tryby pracy: ECB, CBC, CFB, OFB.
- **3DES:** Trzykrotne zastosowanie algorytmu DES, co znacznie zwiększa jego siłę.
- **AES (Advanced Encryption Standard):** Obecnie standard światowy. Jest szybki, darmowy i bardzo bezpieczny (klucze 128, 192, 256 bitów). Stosowany m.in. w WPA2. Zaakceptowany w 2001 r. przez NIST. Działa na blokach 128-bitowych, z kluczami 128, 192 lub 256 bitów. Wykonuje serię rund obejmujących podstawienia bajtów, przesunięcia, mieszanie kolumn i dodanie klucza rundy.
- **RC4:** Szybki szyfr strumieniowy. Znany z zastosowań w protokołach WEP, WPA oraz SSH. Opracowany w 1987 r. przez Rona Rivesta. Jest to szyfr strumieniowy z kluczem o długości od 40 do 2048 bitów. Generuje pseudolosowy ciąg bajtów, który jest łączony z danymi przez operację XOR.
- **Blowfish:** Darmowy i dobrze przebadany algorytm blokowy, charakteryzujący się małym zapotrzebowaniem na pamięć. Opracowany w 1993 r. przez Bruce’a Schneiera. Działa na blokach 64-bitowych, z kluczem od 32 do 448 bitów. Wykorzystuje 16 rund sieci Feistela z dynamicznie generowanymi S-boxami zależnymi od klucza.
- **Inne:** IDEA (blokowy, 64-bitowe bloki, 128-bitowy klucz), RC5 (blokowy, zmienna długość), RC6 (blokowy, finalist AES).

### Algorytmy asymetryczne (z kluczem publicznym)

Wykorzystują parę kluczy: klucz publiczny (jawny dla wszystkich) oraz klucz prywatny (tajny, znany tylko właścicielowi).

Zasada działania: Jeśli zaszyfrujemy wiadomość kluczem publicznym odbiorcy, tylko on może ją odszyfrować swoim kluczem prywatnym.

Bezpieczeństwo: Opiera się na trudności rozwiązaniu problemów matematycznych (np. rozkład dużych liczb na czynniki pierwsze).

#### Przykłady algorytmów asymetrycznych

- **RSA:** Najpopularniejszy algorytm. Jego siła tkwi w trudności faktoryzacji (rozkładu na liczby pierwsze) iloczynu dwóch bardzo dużych liczb pierwszych. Opracowany w 1977 r. przez Rivesta, Shamira i Adlemana. Klucz publiczny i prywatny mają długość zwykle od 1024 do 4096 bitów. Opiera się na potęgowaniach modularnych.
- **El-Gamal:** Opiera się na trudności obliczania logarytmu dyskretnego. Bardzo popularny obok RSA. Opracowany w 1985 r. przez Tahera ElGamala. Klucz publiczny i prywatny bazują na arytmetyce modularnej i logarytmie dyskretnym. Szyfrowanie wykorzystuje losową wartość i potęgowanie modulo dużej liczby pierwszej.
- **LUC:** Podobny do RSA, ale zamiast arytmetyki modulo wykorzystuje ciągi Lucasa. Opracowany w 1992 r. przez Petera Smitha. Wykorzystuje liczby Lucasa, analogiczne do RSA, z kluczami o długości porównywalnej (np. 1024–4096 bitów). Szyfrowanie polega na potęgowaniach modularnych w oparciu o ciąg Lucasa.

> **Ważne:** Algorytmy asymetryczne są znacznie wolniejsze od symetrycznych, dlatego często stosuje się je tylko do przesłania klucza sesji (symetrycznego).

### Funkcje haszujące (Hash Functions)

Algorytmy jednokierunkowe do weryfikacji integralności.

- **MD5:** Opracowany w 1991 r. przez Rona Rivesta. Przetwarza dane w 512-bitowych blokach i generuje 128-bitowy skrót. Obecnie przestarzały (kolizje).
- **SHA-1:** Zaakceptowany w 1995 r. przez NIST. 160-bitowy skrót, przestarzały.
- **SHA-2 (SHA-256):** Zaakceptowany w 2001 r. przez NIST. Rodzina algorytmów (SHA-224, SHA-256, SHA-384, SHA-512). Używa funkcji kompresji opartych na rotacjach, przesunięciach i dodawaniu modulo 2^32 lub 2^64. Wynikiem jest skrót o długości 224–512 bitów.
- **SHA-3:** Zaakceptowany w 2015 r. przez NIST (Keccak). Obsługuje różne długości wyjścia (224, 256, 384, 512 bitów). Stosuje gąbczasty algorytm.

### Praktyczne zastosowania kryptografii

#### Podpis cyfrowy

Służy do potwierdzenia autentyczności dokumentu i tożsamości nadawcy. Działa odwrotnie niż szyfrowanie:

- Nadawca podpisuje dokument swoim kluczem prywatnym.
- Odbiorca weryfikuje podpis ogólnodostępnym kluczem publicznym nadawcy.

Zapewnia: autentyczność, niezmienność treści oraz niezaprzeczalność.

#### Standard X.509

Opisuje strukturę certyfikatów klucza publicznego. Certyfikat jest chroniony podpisem cyfrowym wydawcy (np. CA).

**Obowiązkowe pola:**

1. numer seryjny
2. algorytm podpisu
3. nazwa wydawcy
4. okres ważności
5. klucz publiczny
6. nazwa podmiotu

#### Protokół SSL/TLS

Standard zapewniający bezpieczną komunikację w Internecie (pomiędzy serwerem a klientem).

- Zapewnia prywatność i autentykację.

- Działa niezależnie od aplikacji (może zabezpieczać HTTP, FTP, TELNET).

- Obecnie jego rozwinięciem jest protokół TLS.

### Systemy hybrydowe

W rzeczywistych systemach (np. HTTPS) stosuje się systemy hybrydowe: algorytm asymetryczny (RSA) służy do bezpiecznego ustalenia wspólnego klucza, którym następnie odbywa się szybka transmisja symetryczna (AES).

### Podsumowanie na obronie

- ✅ **Symetryczne:** Jeden klucz, szybkie (AES, DES, RC4). Blokowe vs. strumieniowe.
- ✅ **Asymetryczne:** Para kluczy, wolniejsze (RSA, El-Gamal, LUC). Do wymiany kluczy i podpisu.
- ✅ **Hash:** Jednokierunkowe (SHA-256, MD5 przestarzały). Do integralności.
- ✅ **Zastosowania:** Podpis cyfrowy, certyfikaty X.509, SSL/TLS.
- ✅ **Hybrydowe:** Asymetryczny do nawiązania + symetryczny do danych.

Najważniejszą różnicą jest liczba kluczy: jeden w symetrycznych, para w asymetrycznych. Warto podkreślić, że w rzeczywistych systemach stosuje się systemy hybrydowe.

## Stachu

1. **Symetryczne**

- DES
  - Zaakceptowany w 1977 r. Przez Narodowe Biuro Standardów USA.
  - Dane są szyfrowane w 64-bitowych blokach z zastosowaniem 56 bitowego klucza.
  - Algorytm w serii etapów przetwarza 64-bitowe dane wejściowe na 64-bitowy wynik.
  - W celu odwrócenia operacji stosuje się te same etapy i ten sam klucz.
  - S Bloki
  - Tryby pracy: ECB (książka kodowa), CBC (wiązanie bloków), CFB (sprzężenie zwrotne) , OFB (sprzężenia zwrotnego wyjściowego)
- IDEA
  - Zaakceptowany w 1991 r. (opracowany przez Xuejia Lai i Jamesa Masseya).
  - Operuje na blokach 64-bitowych z użyciem 128-bitowego klucza.
  - Używa ośmiu rund, w których dane są mieszane za pomocą operacji XOR, dodawania modulo 2^16 i mnożenia modulo 2^16+1.
  - Wynikiem jest 64-bitowy blok zaszyfrowanych danych.
- RC4
  - Opracowany w 1987 r. przez Rona Rivesta (RSA Data Security), ujawniony publicznie w 1994.
  - Jest to szyfr strumieniowy z kluczem o długości od 40 do 2048 bitów.
  - Generuje pseudolosowy ciąg bajtów, który jest łączony z danymi przez operację XOR.
  - Wynikiem jest strumień zaszyfrowanych danych o tej samej długości co dane wejściowe
- AES (Rijndael)
  - Zaakceptowany w 2001 r. przez NIST jako standard szyfrowania (FIPS PUB 197)
  - Działa na blokach 128-bitowych, z kluczami 128, 192 lub 256 bitów.
  - Wykonuje serię rund obejmujących podstawienia bajtów, przesunięcia, mieszanie kolumn i dodanie klucza rundy.
  - Wynikiem jest 128-bitowy blok zaszyfrowanych danych.
- RC5
  - Opracowany w 1994 r. przez Rona Rivesta.
  - Działa na blokach o długości 32, 64 lub 128 bitów; długość klucza od 0 do 2040 bitów.
  - Algorytm wykorzystuje operacje arytmetyczne, rotacje i XOR w wielu rundach.
  - Wynikiem jest blok zaszyfrowanych danych o tej samej długości co blok wejściowy.
- RC6
  - Zaprojektowany w 1998 r. przez Rona Rivesta i współpracowników jako rozszerzenie RC5; finalist AES.
  - Działa na blokach 128-bitowych z kluczami 128, 192 lub 256 bitów.
  - Używa rotacji, mnożenia i XOR w czterech rejestrach danych w 20 rundach.
  - Wynikiem jest 128-bitowy blok zaszyfrowanych danych.
- ~~Blowjob~~ Blowfish
  - Opracowany w 1993 r. przez Bruce’a Schneiera.
  - Działa na blokach 64-bitowych, z kluczem od 32 do 448 bitów.
  - Wykorzystuje 16 rund sieci Feistela z dynamicznie generowanymi S-boxami zależnymi od klucza.
  - Wynikiem jest 64-bitowy blok zaszyfrowanych danych.

2. **Asymetryczne**

- RSA
  - Opracowany w 1977 r. przez Rivesta, Shamira i Adlemana.
  - Klucz publiczny i prywatny mają długość zwykle od 1024 do 4096 bitów.
  - Opiera się na potęgowaniach modularnych i trudności faktoryzacji dużych liczb pierwszych.
  - Wynikiem jest blok danych zaszyfrowanych kluczem publicznym lub odszyfrowanych kluczem prywatnym.
- LUC
  - Opracowany w 1992 r. przez Petera Smitha.
  - Wykorzystuje liczby Lucasa, analogiczne do RSA, z kluczami o długości porównywalnej (np. 1024–4096 bitów).
  - Szyfrowanie polega na potęgowaniach modularnych w oparciu o ciąg Lucasa. (Ciąg Lucasa to leciutko zmodyfikowany ciąg Fibonacciego, pierwsze liczby to 2 i 1 zamiast 0 i 1)
  - Wynikiem jest liczba będąca zakodowanym blokiem wiadomości.
- ElGamal
  - Opracowany w 1985 r. przez Tahera ElGamala.
  - Klucz publiczny i prywatny bazują na arytmetyce modularnej i logarytmie dyskretnym.
  - Szyfrowanie wykorzystuje losową wartość i potęgowanie modulo dużej liczby pierwszej.
  - Wynikiem jest para liczb (c1, c2) stanowiąca szyfrogram.

3. **Haszujące**

- MD5
  - Opracowany w 1991 r. przez Rona Rivesta.
  - Przetwarza dane w 512-bitowych blokach i generuje 128-bitowy skrót.
  - Używa serii nieliniowych funkcji, przesunięć i dodawania modulo 2^32.
  - Wynikiem jest 128-bitowy hash (wartość skrótu).
- SHA-1, SHA-2, SHA-3
  - SHA-1
    - Zaakceptowany w 1995 r. przez NIST.
    - Przetwarza dane w blokach 512-bitowych i produkuje 160-bitowy skrót.
    - Operuje na 80 rundach funkcji logicznych, rotacji i dodawania modulo 2^32.
    - Wynikiem jest 160-bitowy hash.
  - SHA-2
    - Zaakceptowany w 2001 r. przez NIST.
    - Rodzina algorytmów: SHA-224, SHA-256, SHA-384, SHA-512, przetwarzających bloki 512 lub 1024-bitowe.
    - Używa funkcji kompresji opartych na rotacjach, przesunięciach i dodawaniu modulo 2^32 lub 2^64.
    - Wynikiem jest skrót o długości 224–512 bitów.
  - SHA-3
    - Zaakceptowany w 2015 r. przez NIST (na podstawie algorytmu Keccak).
    - Obsługuje różne długości wyjścia (224, 256, 384, 512 bitów).
    - Stosuje tzw. gąbczasty (sponge) algorytm z mieszaniem bitów w stanie o rozmiarze 1600 bitów.
    - Wynikiem jest skrót o określonej długości (np. 256 bitów).
- SHA256
  - Część rodziny SHA-2, zaakceptowany w 2001 r. przez NIST.
  - Przetwarza dane w 512-bitowych blokach, z użyciem stałych 32-bitowych i rotacji bitowych.
  - Wykonuje 64 rundy funkcji kompresji i logicznych.
  - Wynikiem jest 256-bitowy skrót.
